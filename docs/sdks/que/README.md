# Que SDK

## Overview

Que API: Welcome to the Que Public HTTP API for C2PA (Content Authenticity Initiative) provenance management.

Our platform provides robust tools for working with digital asset provenance through C2PA manifests, enabling you to sign and verify digital assets to ensure their authenticity, origin, and processing history.

**Key Features:**
*   **Memory-Efficient Streaming**: Assets are processed using streaming techniques to minimize memory usage, supporting large files efficiently
*   **Verify**: Inspect and validate C2PA manifests embedded in assets with multiple detail levels
*   **Sign**: Embed comprehensive C2PA manifests into your assets with server-side cryptographic signatures
*   **Trust Management**: Retrieve and validate against current trust lists containing trusted certificate authorities and manufacturers
*   **Secure Uploads**: Direct-to-S3 uploads via presigned URLs for large assets

**Authentication:**
All endpoints (except for `/healthz`) are secured and require an API key to be passed in the `x-api-key` header.

**Processing Architecture:**
Assets are streamed from S3 or URLs to temporary storage during processing to ensure O(chunk_size) memory usage instead of O(file_size), enabling efficient handling of large files on containerized platforms.

Usage of this API is tracked via Firehose for billing and monitoring purposes.


Find more detailed documentation and tutorials here.
<https://docs.addque.org>

### Available Operations

* [verify_asset](#verify_asset) - Verify the C2PA manifest of an asset
* [sign_asset](#sign_asset) - Sign an asset with a C2PA manifest

## verify_asset

Analyzes a digital asset to find, validate, and report on any embedded C2PA manifests. This allows you to confirm the asset's provenance, authenticity, and processing history.

The asset is processed using memory-efficient streaming to temporary storage during verification. Returns detailed validation results including trust status, signer information, and any validation failures.


### Example Usage

<!-- UsageSnippet language="python" operationID="verifyAsset" method="post" path="/v1/verify" -->
```python
import os
from que_media import Que


with Que(
    api_key_auth=os.getenv("QUE_API_KEY_AUTH", ""),
) as que:

    res = que.verify_asset(asset={
        "bucket": "que-assets-dev",
        "key": "uploads/photo.jpg",
    }, mode="summary", allow_remote_manifests=False, allow_insecure_remote_http=False, include_certificates=True, limits={
        "max_asset_size_bytes": 104857600,
        "max_output_size_bytes": 104857600,
        "max_stream_copy_bytes": 104857600,
        "stream_timeout_ms": 30000,
    })

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                                                                                                                                                                        | Type                                                                                                                                                                                                                                                                                                                                                                                                                                             | Required                                                                                                                                                                                                                                                                                                                                                                                                                                         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                      | Example                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `asset`                                                                                                                                                                                                                                                                                                                                                                                                                                          | [models.AssetRefDto](../../models/assetrefdto.md)                                                                                                                                                                                                                                                                                                                                                                                                | :heavy_check_mark:                                                                                                                                                                                                                                                                                                                                                                                                                               | A reference to a digital asset, either stored in S3 or accessible via URL. Files are streamed efficiently to temporary storage during processing to minimize memory usage.                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `mode`                                                                                                                                                                                                                                                                                                                                                                                                                                           | *Optional[str]*                                                                                                                                                                                                                                                                                                                                                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                               | The level of detail to return in the verification report.<br/>* `summary`: A high-level pass/fail result with basic trust status. Fastest option for simple validation.<br/>* `info`: Basic information about the manifest, claims, and signing entities.<br/>* `detailed`: Comprehensive details of all assertions, claims, signatures, and validation steps.<br/>* `tree`: Hierarchical view of the manifest's ingredient relationships and provenance chain.<br/> | detailed                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `allow_remote_manifests`                                                                                                                                                                                                                                                                                                                                                                                                                         | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                               | Whether to allow fetching and validating remote manifests referenced in the asset's C2PA data.                                                                                                                                                                                                                                                                                                                                                   | false                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `allow_insecure_remote_http`                                                                                                                                                                                                                                                                                                                                                                                                                     | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                               | Whether to allow HTTP (non-HTTPS) URLs when fetching remote manifest resources. Disabled by default for security.                                                                                                                                                                                                                                                                                                                                | false                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| `include_certificates`                                                                                                                                                                                                                                                                                                                                                                                                                           | *Optional[bool]*                                                                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                               | Whether to include full certificate chains and cryptographic details in the verification report.                                                                                                                                                                                                                                                                                                                                                 | true                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `cawg`                                                                                                                                                                                                                                                                                                                                                                                                                                           | [Optional[models.CawgVerifyDto]](../../models/cawgverifydto.md)                                                                                                                                                                                                                                                                                                                                                                                  | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                               | Options controlling CAWG identity validation behavior during verification.                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `limits`                                                                                                                                                                                                                                                                                                                                                                                                                                         | [Optional[models.LimitsDto]](../../models/limitsdto.md)                                                                                                                                                                                                                                                                                                                                                                                          | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                               | Optional limits for processing operations to prevent resource exhaustion. These limits apply to the streaming and processing phases of asset handling.                                                                                                                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `retries`                                                                                                                                                                                                                                                                                                                                                                                                                                        | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                                                                                                                                                                                 | :heavy_minus_sign:                                                                                                                                                                                                                                                                                                                                                                                                                               | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                                                                                                                                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                  |

### Response

**[models.VerifyAssetResponse](../../models/verifyassetresponse.md)**

### Errors

| Error Type                  | Status Code                 | Content Type                |
| --------------------------- | --------------------------- | --------------------------- |
| errors.ProblemResponseError | 400, 401, 403, 422          | application/problem+json    |
| errors.ProblemResponseError | 429                         | application/problem+json    |
| errors.ProblemResponseError | 500                         | application/problem+json    |
| errors.QueDefaultError      | 4XX, 5XX                    | \*/\*                       |

## sign_asset

Embeds a C2PA manifest into a digital asset and signs it using a server-side cryptographic key. The asset is processed using memory-efficient streaming to temporary storage before signing.

This operation cryptographically links the asset to its provenance information, creating an immutable record of the asset's origin, authorship, and any processing history.


### Example Usage

<!-- UsageSnippet language="python" operationID="signAsset" method="post" path="/v1/sign" -->
```python
import os
from que_media import Que, models


with Que(
    api_key_auth=os.getenv("QUE_API_KEY_AUTH", ""),
) as que:

    res = que.sign_asset(asset={
        "bucket": "que-assets-dev",
        "key": "uploads/photo.jpg",
    }, mode=models.Mode.SERVER_MEASURE, manifest_json="{\"title\":\"Original Photograph\",\"assertions\":[{\"label\":\"stds.schema-org.CreativeWork\",\"data\":{\"@context\":\"https://schema.org\",\"@type\":\"CreativeWork\",\"author\":[{\"@type\":\"Person\",\"name\":\"Jane Photographer\"}]}}]}", allow_insecure_remote_http=False, limits={
        "max_asset_size_bytes": 104857600,
        "max_output_size_bytes": 104857600,
        "max_stream_copy_bytes": 104857600,
        "stream_timeout_ms": 30000,
    })

    # Handle response
    print(res)

```

### Parameters

| Parameter                                                                                                                                                                                                                                                                                      | Type                                                                                                                                                                                                                                                                                           | Required                                                                                                                                                                                                                                                                                       | Description                                                                                                                                                                                                                                                                                    | Example                                                                                                                                                                                                                                                                                        |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `asset`                                                                                                                                                                                                                                                                                        | [models.AssetRefDto](../../models/assetrefdto.md)                                                                                                                                                                                                                                              | :heavy_check_mark:                                                                                                                                                                                                                                                                             | A reference to a digital asset, either stored in S3 or accessible via URL. Files are streamed efficiently to temporary storage during processing to minimize memory usage.                                                                                                                     |                                                                                                                                                                                                                                                                                                |
| `mode`                                                                                                                                                                                                                                                                                         | [models.Mode](../../models/mode.md)                                                                                                                                                                                                                                                            | :heavy_check_mark:                                                                                                                                                                                                                                                                             | The signing mode to use.<br/>* `server_measure`: The server streams the asset, calculates its hash, and embeds the manifest. Requires `manifest_json`. This is the primary signing mode.<br/>* `client_hash`: The client provides the asset hash directly for offline signing. (Not yet implemented).<br/> | server_measure                                                                                                                                                                                                                                                                                 |
| `manifest_json`                                                                                                                                                                                                                                                                                | *Optional[str]*                                                                                                                                                                                                                                                                                | :heavy_minus_sign:                                                                                                                                                                                                                                                                             | JSON string containing the manifest to embed in the asset as a C2PA claim. This defines the provenance information and assertions about the asset. Required when `mode` is `server_measure`.                                                                                                   | {"title":"Original Photograph","format":"image/jpeg","assertions":[{"label":"stds.schema-org.CreativeWork","data":{"@context":"https://schema.org","@type":"CreativeWork","author":[{"@type":"Person","name":"Jane Photographer"}]}}]}                                                         |
| `cawg`                                                                                                                                                                                                                                                                                         | [Optional[models.CawgIdentityDto]](../../models/cawgidentitydto.md)                                                                                                                                                                                                                            | :heavy_minus_sign:                                                                                                                                                                                                                                                                             | Configuration to add a CAWG identity assertion during signing. Presence of this object enables CAWG.                                                                                                                                                                                           |                                                                                                                                                                                                                                                                                                |
| `allow_insecure_remote_http`                                                                                                                                                                                                                                                                   | *Optional[bool]*                                                                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                             | Whether to allow HTTP (non-HTTPS) URLs for remote manifest resources. Disabled by default for security.                                                                                                                                                                                        | false                                                                                                                                                                                                                                                                                          |
| `limits`                                                                                                                                                                                                                                                                                       | [Optional[models.LimitsDto]](../../models/limitsdto.md)                                                                                                                                                                                                                                        | :heavy_minus_sign:                                                                                                                                                                                                                                                                             | Optional limits for processing operations to prevent resource exhaustion. These limits apply to the streaming and processing phases of asset handling.                                                                                                                                         |                                                                                                                                                                                                                                                                                                |
| `retries`                                                                                                                                                                                                                                                                                      | [Optional[utils.RetryConfig]](../../models/utils/retryconfig.md)                                                                                                                                                                                                                               | :heavy_minus_sign:                                                                                                                                                                                                                                                                             | Configuration to override the default retry behavior of the client.                                                                                                                                                                                                                            |                                                                                                                                                                                                                                                                                                |

### Response

**[models.SignAssetResponse](../../models/signassetresponse.md)**

### Errors

| Error Type                  | Status Code                 | Content Type                |
| --------------------------- | --------------------------- | --------------------------- |
| errors.ProblemResponseError | 400, 401, 403, 422          | application/problem+json    |
| errors.ProblemResponseError | 429                         | application/problem+json    |
| errors.ProblemResponseError | 500                         | application/problem+json    |
| errors.QueDefaultError      | 4XX, 5XX                    | \*/\*                       |